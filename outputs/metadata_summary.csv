from pathlib import Path
import pandas as pd

meta_dir = Path("/content/drive/MyDrive/TÜBİTAK/extracted/metadata/metadata")
out_dir  = Path("/content/drive/MyDrive/TÜBİTAK/outputs")
out_dir.mkdir(parents=True, exist_ok=True)

files = sorted(meta_dir.glob("*_metadata.csv"))
print("Found metadata files:", len(files))
for f in files:
    print(" -", f.name)

rows = []
all_cols = set()

for f in files:
    df = pd.read_csv(f)
    rows.append({
        "sample": f.name.replace("_metadata.csv",""),
        "n_rows": len(df),
        "n_cols": df.shape[1],
        "columns": ", ".join(df.columns)
    })
    all_cols.update(df.columns)

summary = pd.DataFrame(rows).sort_values("sample")
print("\n=== Summary (rows/cols) ===")
display(summary[["sample","n_rows","n_cols"]])

print("\n=== All columns (union) ===")
print(sorted(all_cols))

# show one example file (first one)
example = pd.read_csv(files[0])
print("\n=== Example file:", files[0].name, "===")
display(example.head(10))

# save summary to Drive
summary_path = out_dir / "metadata_summary.csv"
summary.to_csv(summary_path, index=False)
print("\n✅ Saved:", summary_path)
